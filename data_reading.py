import pandas as pd
import s3fs

key_id = '9VVSY17LTE64MVGEH8NL'
access_key = 'qxufI+XcvY4vyhYVTzSI+Wj6wWYCT+51wENLtgqP'
token = "eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJhY2Nlc3NLZXkiOiI5VlZTWTE3TFRFNjRNVkdFSDhOTCIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiKiJdLCJhdWQiOlsibWluaW8tZGF0YW5vZGUiLCJvbnl4aWEiLCJhY2NvdW50Il0sImF1dGhfdGltZSI6MTY1NDUxMjg5NSwiYXpwIjoib255eGlhIiwiZW1haWwiOiJpZHJpc3NhLmtvbmtvYm9AZW5zYWUuZnIiLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwiZXhwIjoxNjU0NTk5Mjk2LCJmYW1pbHlfbmFtZSI6IktPTktPQk8iLCJnaXZlbl9uYW1lIjoiSWRyaXNzYSIsImdyb3VwcyI6W10sImlhdCI6MTY1NDUxMjg5NSwiaXNzIjoiaHR0cHM6Ly9hdXRoLmxhYi5zc3BjbG91ZC5mci9hdXRoL3JlYWxtcy9zc3BjbG91ZCIsImp0aSI6ImQ4ZDljMTk2LTA2YjQtNDBiNS04NDU1LWZiM2Y5OThiN2M3OCIsImxvY2FsZSI6ImVuIiwibmFtZSI6Iklkcmlzc2EgS09OS09CTyIsIm5vbmNlIjoiZjY4NjEyZjktM2FmMC00YjJjLWJiNmMtMjVkYTVmMmIzZTIwIiwicG9saWN5Ijoic3Rzb25seSIsInByZWZlcnJlZF91c2VybmFtZSI6Imlrb25rb2JvIiwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbIm9mZmxpbmVfYWNjZXNzIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBwcm9maWxlIGdyb3VwcyBlbWFpbCIsInNlc3Npb25fc3RhdGUiOiJhNWU3M2Q3ZC1hNTcwLTRlY2QtOGRhZi1jMWU3NzRhMTMyNTMiLCJzaWQiOiJhNWU3M2Q3ZC1hNTcwLTRlY2QtOGRhZi1jMWU3NzRhMTMyNTMiLCJzdWIiOiIwYjFjNmFjOC03MmU0LTQ5MWMtYjJmMC0yMDhmZmI4YjFjYjUiLCJ0eXAiOiJCZWFyZXIifQ.zj6DBQos3yHu-jAX6Ucbr0BUAwXA0dT9wxR7JbEY0CvazPGguQFv9Yz7aLtgG1uzLmNBWhuNBG8QwMPX_et5kg"


fs = s3fs.S3FileSystem(client_kwargs={'endpoint_url': 'https://'+'minio.lab.sspcloud.fr'},
                      key = key_id, 
                      secret = access_key, 
                      token = token)


comms_df = pd.read_sas(fs.open("ikonkobo/commsdata/commsdata.sas7bdat"), format='sas7bdat')

comms_df.to_csv("commsdata.csv")